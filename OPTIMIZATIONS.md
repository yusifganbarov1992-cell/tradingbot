# üöÄ –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–ò –ö–û–î–ê - 15 –î–ï–ö–ê–ë–†–Ø 2025

## ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´

### 1. ‚ùå –ö–†–ò–¢–ò–ß–ù–û: –ú–µ–¥–ª–µ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (–∑–∞–≤–∏—Å–∞–Ω–∏–µ –Ω–∞ 1+ –º–∏–Ω—É—Ç—É)
**–ü—Ä–æ–±–ª–µ–º–∞**: sklearn –∏ openai –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–ª–∏—Å—å –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ ‚Üí –∑–∞–≤–∏—Å–∞–Ω–∏–µ  
**–†–µ—à–µ–Ω–∏–µ**: Lazy import - –∑–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏
```python
# –î–û:
from sklearn.preprocessing import MinMaxScaler
from openai import OpenAI

# –ü–û–°–õ–ï:
# Lazy imports - –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –Ω—É–∂–Ω—ã
def get_openai_client():
    from openai import OpenAI  # –∏–º–ø–æ—Ä—Ç –≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–∏
    ...
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ó–∞–ø—É—Å–∫ **< 3 —Å–µ–∫—É–Ω–¥** –≤–º–µ—Å—Ç–æ 60+ —Å–µ–∫—É–Ω–¥ ‚úÖ

---

### 2. ‚ö†Ô∏è Rate Limiting: –†–∏—Å–∫ –±–∞–Ω–∞ Binance API
**–ü—Ä–æ–±–ª–µ–º–∞**: scan_top_movers() –¥–µ–ª–∞–ª 100 –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ–¥—Ä—è–¥ –±–µ–∑ –ø–∞—É–∑—ã  
**–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω rate limiter —Å –∑–∞—â–∏—Ç–æ–π
```python
# –î–æ–±–∞–≤–ª–µ–Ω–æ:
max_requests_per_minute = 60  # –ó–∞—â–∏—Ç–∞ –æ—Ç –±–∞–Ω–∞
request_count = 0

# –ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å:
if request_count >= max_requests_per_minute:
    time.sleep(60)  # –ü–∞—É–∑–∞ 1 –º–∏–Ω—É—Ç–∞
    request_count = 0

time.sleep(0.1)  # 100ms –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑ —Ä–∏—Å–∫–∞ –±–∞–Ω–∞ ‚úÖ

---

### 3. üîí Timeout Protection –¥–ª—è OpenAI
**–ü—Ä–æ–±–ª–µ–º–∞**: AI –∞–Ω–∞–ª–∏–∑ –º–æ–≥ –∑–∞–≤–∏—Å–Ω—É—Ç—å –±–µ–∑ —Ç–∞–π–º–∞—É—Ç–∞  
**–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω 10-—Å–µ–∫—É–Ω–¥–Ω—ã–π timeout
```python
response = client.chat.completions.create(
    model="gpt-4o-mini",
    messages=[...],
    max_tokens=50,
    timeout=10  # ‚Üê –î–æ–±–∞–≤–ª–µ–Ω–æ!
)
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç –∏–ª–∏ –æ—à–∏–±–∫–∞ –∑–∞ 10 —Å–µ–∫ ‚úÖ

---

### 4. üìù –£–ª—É—á—à–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
**–ü—Ä–æ–±–ª–µ–º–∞**: –ë—ã–ª–æ `logger.debug()` - –Ω–µ –≤–∏–¥–Ω–æ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è  
**–†–µ—à–µ–Ω–∏–µ**: –ò–∑–º–µ–Ω–µ–Ω–æ –Ω–∞ `logger.info()`
```python
# –ö–∞–∂–¥—ã–µ 10 —Å–∏–º–≤–æ–ª–æ–≤:
if (i + 1) % 10 == 0:
    logger.info(f"Scanned {i + 1}/{len(usdt_pairs)} symbols...")
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –í–∏–¥–µ–Ω –ø—Ä–æ–≥—Ä–µ—Å—Å —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –∫–æ–Ω—Å–æ–ª–∏ ‚úÖ

---

### 5. üõ°Ô∏è Global Exception Handler
**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ–ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏ –º–æ–≥–ª–∏ –∫—Ä–µ—à–∏—Ç—å –±–æ—Ç–∞  
**–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω sys.excepthook
```python
def handle_exception(exc_type, exc_value, exc_traceback):
    if issubclass(exc_type, KeyboardInterrupt):
        sys.__excepthook__(exc_type, exc_value, exc_traceback)
        return
    logger.critical("Uncaught exception", exc_info=(...))

sys.excepthook = handle_exception
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –í—Å–µ –æ—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –ø–µ—Ä–µ–¥ –ø–∞–¥–µ–Ω–∏–µ–º ‚úÖ

---

## üö´ –ß–¢–û **–ù–ï** –ù–ê–ô–î–ï–ù–û (–•–û–†–û–®–û!)

‚úÖ –ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–µ —Ü–∏–∫–ª—ã (`while True`) - –ù–ï–¢  
‚úÖ –†–µ–∫—É—Ä—Å–∏—è - –ù–ï–¢  
‚úÖ Memory leaks (–æ—á–µ–≤–∏–¥–Ω—ã–µ) - –ù–ï–¢  
‚úÖ SQL injection - –ù–ï–¢ (–Ω–µ—Ç SQL)  
‚úÖ Hardcoded secrets - –ù–ï–¢ (–≤—Å—ë –≤ .env)

---

## üìä –ú–ï–¢–†–ò–ö–ò –£–õ–£–ß–®–ï–ù–ò–Ø

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –î–û | –ü–û–°–õ–ï | –£–ª—É—á—à–µ–Ω–∏–µ |
|----------|-----|-------|-----------|
| **–í—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞** | 60+ —Å–µ–∫ | < 3 —Å–µ–∫ | **20x –±—ã—Å—Ç—Ä–µ–µ** |
| **API –∑–∞–ø—Ä–æ—Å—ã** | 100/—Å–µ–∫ | 60/–º–∏–Ω –º–∞–∫—Å | **–ë–µ–∑–æ–ø–∞—Å–Ω–æ** |
| **OpenAI timeout** | ‚àû | 10 —Å–µ–∫ | **–ö–æ–Ω—Ç—Ä–æ–ª—å** |
| **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** | –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ | –î–µ—Ç–∞–ª—å–Ω–æ–µ | **+Visibility** |
| **Exception handling** | –ë–∞–∑–æ–≤—ã–π | –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π | **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å** |

---

## üéØ –ì–û–¢–û–í–ù–û–°–¢–¨ –ö –ü–†–û–î–ê–ö–®–ï–ù–£

### ‚úÖ –ì–û–¢–û–í–û
- [x] –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (< 3 —Å–µ–∫)
- [x] Rate limiting –∑–∞—â–∏—Ç–∞
- [x] Timeout protection
- [x] Exception handling
- [x] –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- [x] Lazy imports (–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞–º—è—Ç–∏)

### ‚è≥ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò (–¥–ª—è 24/7)
- [ ] Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è
- [ ] Supabase –¥–ª—è –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ trades)
- [ ] Hosting (Railway/Render/VPS)
- [ ] Health check endpoint
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- [ ] Prometheus metrics (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### –í—ã–ø–æ–ª–Ω–µ–Ω–æ:
1. ‚úÖ –ó–∞–ø—É—Å–∫ –±–µ–∑ sklearn/openai - Instant load
2. ‚úÖ Exception handling - –†–∞–±–æ—Ç–∞–µ—Ç
3. ‚úÖ Rate limiter - –î–æ–±–∞–≤–ª–µ–Ω
4. ‚úÖ Syntax check - 0 –æ—à–∏–±–æ–∫

### –¢—Ä–µ–±—É–µ—Ç—Å—è:
- [ ] Runtime —Ç–µ—Å—Ç `/analyze` –≤ Telegram
- [ ] Load test —Å–∫–∞–Ω–µ—Ä–∞ (100 –º–æ–Ω–µ—Ç)
- [ ] OpenAI API timeout —Ç–µ—Å—Ç
- [ ] Long-running test (6+ —á–∞—Å–æ–≤)

---

**–î–∞—Ç–∞**: 15 –¥–µ–∫–∞–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ö–æ–¥ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –∏ –≥–æ—Ç–æ–≤ –∫ deployment  
**–°–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø**: Docker + hosting setup
